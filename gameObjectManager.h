//--------------------------------------------------------------------------------
//
//　gameObjManager.h
//	Author : Xu Wenjie
//	Date   : 2017-5-10
//--------------------------------------------------------------------------------
#pragma once

//--------------------------------------------------------------------------------
//  インクルードファイル
//--------------------------------------------------------------------------------
#include "main.h"

//--------------------------------------------------------------------------------
//  列挙型定義
//--------------------------------------------------------------------------------
enum Layer
{
	Default = 0,
	Max
};

//--------------------------------------------------------------------------------
//  前方宣言
//--------------------------------------------------------------------------------
class GameObject;

//--------------------------------------------------------------------------------
//  クラス宣言
//--------------------------------------------------------------------------------
class GameObjectManager
{
public:
	//--------------------------------------------------------------------------------
	//  関数定義
	//--------------------------------------------------------------------------------
	static auto	Create(void)
	{
		if (instance) return instance;
		instance = new GameObjectManager;
		return instance;
	}
	static void Release(void) { SAFE_UNINIT(instance); }
	static auto Instance(void) { return instance; }

	void ReleaseAll(void);
	void Update(void);
	void LateUpdate(void);
	void Register(GameObject* gameObject, const Layer& layer = Default)
	{
		GameObjects[layer].push_back(gameObject);
	}

private:
	//--------------------------------------------------------------------------------
	//  関数定義
	//--------------------------------------------------------------------------------
	GameObjectManager() { for (auto& list : GameObjects) list.clear(); }
	~GameObjectManager() {}
	void uninit(void) { ReleaseAll(); }

	//--------------------------------------------------------------------------------
	//  変数定義
	//--------------------------------------------------------------------------------
	list<GameObject*>			GameObjects[Layer::Max];
	static GameObjectManager*	instance;
};