//--------------------------------------------------------------------------------
//	物理演算システム
//　KF_PhysicsSystem.h
//	Author : Xu Wenjie
//	Date   : 2017-07-25
//--------------------------------------------------------------------------------
#pragma once

//--------------------------------------------------------------------------------
//  インクルードファイル
//--------------------------------------------------------------------------------

//--------------------------------------------------------------------------------
//  前方宣言
//--------------------------------------------------------------------------------
class CCollision;

//--------------------------------------------------------------------------------
//  クラス宣言
//--------------------------------------------------------------------------------
//--------------------------------------------------------------------------------
//  物理演算システム
//--------------------------------------------------------------------------------
class CKFPhysicsSystem
{
public:
	//--------------------------------------------------------------------------------
	//  定数定義
	//--------------------------------------------------------------------------------
	static const CKFVec3 sc_vGravity;	//重力

	//--------------------------------------------------------------------------------
	//  関数宣言
	//--------------------------------------------------------------------------------
	CKFPhysicsSystem() { m_listCollision.clear(); }
	~CKFPhysicsSystem() {}

	bool	Init(void);
	void	Uninit(void);
	void	Release(void);
	void	Update(void);

	void	RegisterCollision(CCollision* pCollision);

private:
	//--------------------------------------------------------------------------------
	//  関数宣言
	//--------------------------------------------------------------------------------
	void	resolve(CCollision& collision);
	void	resolveVelocity(CCollision& collision);
	void	resolveInterpenetration(CCollision& collision);
	float	calculateSeparatingVelocity(CCollision& collision);
	void	calculateCollisionBasis(CCollision& collision);

	//--------------------------------------------------------------------------------
	//  変数宣言
	//--------------------------------------------------------------------------------
	list<CCollision*> m_listCollision;
};